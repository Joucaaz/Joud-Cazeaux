jQuery(function($){ajaxCallFunction();projectsPlayer();removeHoverCSSRule();$.ajaxSetup({cache:true});let vh=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${vh}px`);window.addEventListener("resize",()=>{let vh=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${vh}px`)})});var xhr=new window.XMLHttpRequest;if(typeof ytLoaded==="undefined"){var ytLoaded=false}if(!ytLoaded){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}var checkYT3=setInterval(function(){window.onYouTubeIframeAPIReady=function(){ytLoaded=true};if(ytLoaded){clearInterval(checkYT3)}},500);function removeHoverCSSRule(){if("createTouch"in document){try{var ignore=/:hover/;for(var i=0;i<document.styleSheets.length;i++){var sheet=document.styleSheets[i];if(!sheet.cssRules){continue}for(var j=sheet.cssRules.length-1;j>=0;j--){var rule=sheet.cssRules[j];if(rule.type===CSSRule.STYLE_RULE&&ignore.test(rule.selectorText)){sheet.deleteRule(j)}}}}catch(e){}}}function projectsPlayer(){console.log("projectsPlayer started");$("#container").off("click").on("click",".itemProjet",function(event){console.log("click on .itemProjet vignette");var linkClicked=$(this);var container=linkClicked.parents("div.project-container, div.narrative-item");var contentContainer=container.find(".content-container");if(container.length!==0){$(".video-js").each(function(){videojs(this.id).ready(function(){myPlayer=this;if(myPlayer.hasStarted()){myPlayer.pause()}})});if(typeof vimeoList!=="undefined"){for(var key in vimeoList){vimeoList[key].pause()}}if(typeof youtubeList!=="undefined"){console.log("pause all youtube players");for(var key in youtubeList){console.log("==>");console.log("trying pause yt player, key :"+key);console.log("ytLoaded :: "+ytLoaded);console.log("typeof youtubeList[key] :: "+typeof youtubeList[key]);console.log(youtubeList[key]);if(ytLoaded&&typeof youtubeList[key]==="object"){console.log("youtubeList[key].getPlayerState() : "+youtubeList[key].getPlayerState());if(typeof youtubeList[key].getPlayerState()==="function"&&youtubeList[key].getPlayerState()==1){youtubeList[key].pauseVideo();console.log("> pause yt player")}}console.log("==<")}}var maxHeight=container.find(".vignette-container").height();container.addClass("vignette-fade-in player-opened");if(container.hasClass("bandeau-item")==false&&container.hasClass("narrative-item")==false){container.height(maxHeight)}if(container.hasClass("bandeau-item")==false){container.find("iframe").css("height",maxHeight)}var idContainer=container.attr("id");$(".player-opened").not("#"+idContainer).removeClass("player-opened");if(contentContainer.find(".video-js").length>0){if(contentContainer.find(".video-js").attr("id")){videojs(contentContainer.find(".video-js").attr("id")).ready(function(){myPlayer=this;myPlayer.play()})}}else if(contentContainer.find(".vimeo").length>0){var playerId=contentContainer.find(".vimeo").attr("id");if(playerId){if(typeof vimeoList!=="undefined"&&isset(vimeoList[playerId])){vimeoList[playerId].play()}else if(typeof vimeoListConfig!=="undefined"){if(isset(vimeoListConfig[playerId])){vimeoList[playerId]=new Vimeo.Player(vimeoListConfig[playerId].containerId,vimeoListConfig[playerId].config);vimeoList[playerId].play()}}}}else if(contentContainer.find(".youtube").length>0){var playerId=contentContainer.find(".youtube").data("player-id");if(!isset(youtubeList[playerId])){console.log(">---");console.log(youtubeList);console.log(typeof youtubeList);console.log(playerId);console.log(isset(youtubeList[playerId]));console.log("---<")}if(playerId){if(!isset(youtubeList[playerId])){var checkYT2A=setInterval(function(){console.log("attente listing player");if(isset(youtubeList[playerId])){clearInterval(checkYT2A);console.log("fin attente listing player")}},100)}var checkYT2=setInterval(function(){if(ytLoaded&&typeof youtubeList[playerId]=="object"){console.log(youtubeList[playerId]);youtubeList[playerId].playVideo();clearInterval(checkYT2)}},300)}}}return false});$("#container").off("click",".open-partie-2 a").on("click",".open-partie-2 a",function(){var blocContainerDescriptions=$(this).parents("div.infos");if(blocContainerDescriptions.hasClass("opened-partie-2")){$(".open-partie-2",blocContainerDescriptions).removeClass("clicked");blocContainerDescriptions.removeClass("opened-partie-2")}else{$(".open-partie-2",blocContainerDescriptions).addClass("clicked");blocContainerDescriptions.addClass("opened-partie-2")}return false});$("#container").off("mouseenter",".content-container").on("mouseenter",".content-container",function(){$(".infos",this).removeClass("closed");$(this).off("mouseleave").on("mouseleave",function(){$(".infos",this).addClass("closed")})})}function onScrollAnimate(){var lastscrollposition=$(window).scrollTop();$(window).off("scroll").on("scroll",function(event){var heightDocument=$(document).height();var heightWindow=$(window).height();var widthWindow=$(window).width();var heightDocumentReduce=heightDocument-widthWindow/2*.45;var scroll=$(window).scrollTop();if(scroll>0){$("body").removeClass("scrolled-top").addClass("scrolled");if($(".bandeau-item.scroll-anim").length>0){if(lastscrollposition==0){disableScroll();setTimeout(function(){enableScroll()},1e3)}}}else{$("body").removeClass("scrolled");if(heightDocumentReduce>heightWindow){$("body").addClass("scrolled-top")}}lastscrollposition=scroll})}if(typeof UpdateDomViaAjax==="undefined"){var UpdateDomViaAjax={canFadeIn:true,fadeInfinished:null,fadeIn:function(){$("body").removeClass("ajax-calling");$("#container").animate({opacity:1},200,function(){})},updateContent:function(content){if(typeof controller==="object"){controller=controller.destroy(true)}UpdateDomViaAjax.fadeInfinished=setInterval(function(){if(UpdateDomViaAjax.canFadeIn){clearTimeout(UpdateDomViaAjax.fadeInfinished);$("html, body").animate({scrollTop:0},0);$("body").removeClass("scrolled-top").removeClass("scrolled");$("#container").html(content);UpdateDomViaAjax.fadeIn()}},100)},fadeOut:function(){UpdateDomViaAjax.canFadeIn=false;$("#container").animate({opacity:0},200,function(){$("body").addClass("ajax-calling");UpdateDomViaAjax.canFadeIn=true})},activateDirectors:function(idDirector){$("#panel-directors-items li").not(".director-"+idDirector).removeClass("active").addClass("fadeout");$("#panel-directors-items li.director-"+idDirector).addClass("active").removeClass("fadeout")},unactivateDirectors:function(){$("#panel-directors-items li").removeClass("active").removeClass("fadeout")},activateCategories:function(idCategorie){if($(".categorie-"+idCategorie).length>0){$(".categorie-"+idCategorie).each(function(){$(this).parent("ul").find("li").not(".categorie-"+idCategorie).removeClass("active").addClass("fadeout");$(this).addClass("active").removeClass("fadeout")})}},unactivateCategories:function(){$("#panel-categories-items li").removeClass("active").removeClass("fadeout")},selectMenuTopBar:function(menuToSelect){},showPlayerProjet:function(linkClicked,datas){var container=linkClicked.parents("div.project-container, div.narrative-item");var contentContainer=container.find(".content-container");if(container.length!==0){var maxHeight=container.find(".vignette-container").height();container.addClass("vignette-fade-in player-opened");if(container.hasClass("bandeau-item")==false){}if(isset(datas)){contentContainer.addClass("opened").html(datas.content)}contentContainer.find("video").css("max-height",maxHeight);if(container.hasClass("bandeau-item")==false){container.find("iframe").css("height",maxHeight)}var idContainer=container.attr("id");$(".player-opened").not("#"+idContainer).removeClass("player-opened");videojs(contentContainer.find(".video-js").attr("id")).ready(function(){myPlayer=this;myPlayer.play()})}}}}function ajaxCallFunctionExecForms(form,e){e.preventDefault();$.ajax({type:$(form).attr("method"),dataType:"json",url:$(form).attr("action"),data:$(form).serialize(),beforeSend:function(){if(form.hasClass("no-loader")!==true){UpdateDomViaAjax.fadeOut()}},complete:function(data){},success:function(data){if(isset(data.messageType)){$(".message",form).attr("class","message").addClass(data.messageType)}if(isset(data.messageText)){$(".message",form).html(data.messageText)}if(isset(data.htmlParts)){applychanges(data.htmlParts)}if(isset(data.header)){$("header").html(data.header)}if(isset(data.content)){UpdateDomViaAjax.updateContent(data.content)}else{UpdateDomViaAjax.fadeIn()}if(form.hasClass("no-close-panel")!==true){if(headerActions.panel.isOpened===true){headerActions.panel.hide(true)}}ajaxCallFunction();projectsPlayer();$(".loader",form).removeClass("active")},error:function(XMLHttpRequest,textStatus,errorThrown){$("#container").html(XMLHttpRequest.responseText);UpdateDomViaAjax.fadeIn()}})}function ajaxCallFunctionExecLinks(linkClicked,e){$.ajax({type:"GET",dataType:"json",url:$(linkClicked).attr("href"),beforeSend:function(){if(linkClicked.hasClass("no-loader")!==true){UpdateDomViaAjax.fadeOut()}},complete:function(){},success:function(data){if(linkClicked.hasClass("itemProjet")!==true){var stateObj={urlPath:$(linkClicked).attr("href")};history.pushState(stateObj,data.title,$(linkClicked).attr("href"));if(isset(data.title)){$("title").html(data.title)}}if(isset(data.header)){if(headerActions.panel.isOpened===true){headerActions.panel.hide(true)}setTimeout(function(){$("header").html(data.header)},250)}if(isset(data.bodyClass)){$("body").attr("class",data.bodyClass)}if(isset(data.htmlParts)){data.htmlParts}if(linkClicked.hasClass("itemProjet")){UpdateDomViaAjax.showPlayerProjet(linkClicked,data)}else{$(".top-bar").removeClass("medium-bg-white-left").removeClass("small-bg-white");if(isset(data.content)){UpdateDomViaAjax.updateContent(data.content);if(linkClicked.prop("hash")){setTimeout(function(){$(document).scrollTop($(linkClicked.prop("hash")).offset().top)},250)}}}if(isset(data.idDirector)&&data.idDirector){UpdateDomViaAjax.activateDirectors(data.idDirector);UpdateDomViaAjax.unactivateCategories();$(".top-bar").addClass("medium-bg-white-left").addClass("small-bg-white")}else{}if(isset(data.idCategorie)&&data.idCategorie){UpdateDomViaAjax.activateCategories(data.idCategorie);UpdateDomViaAjax.unactivateDirectors()}if(isset(data.headerMessage)){headerActions.topbar.setMessage(data.headerMessage)}else{headerActions.topbar.setMessage("")}var hashTag=window.location.hash;if(hashTag){var yOffset=$(hashTag).offset().top;$("html,body").animate({scrollTop:yOffset},100)}$("body").removeClass("index-focus");ajaxCallFunction();projectsPlayer()},error:function(XMLHttpRequest,textStatus,errorThrown){UpdateDomViaAjax.fadeIn();window.location=$(linkClicked).attr("href")}})}function ajaxCallFunction(){$(document).off("click","a:not(.fp-ui a, .noAjax)").on("click","a:not(.fp-ui a, .noAjax)",function(e){ajaxCallFunctionExecLinks($(this),e);return false});$("form").unbind("submit").on("submit",function(e){ajaxCallFunctionExecForms($(this),e);return false});onScrollAnimate()}window.addEventListener("popstate",function(e){console.log(e);var state=e.state;if(state===null){window.location.replace("/");x}else if(state.urlPath!==undefined){window.location.replace(state.urlPath)}else if(typeof state==="string"||state instanceof String){window.location.replace(state)}});